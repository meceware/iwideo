/* 
 * iwideo v1.0.1
 * https://github.com/meceware/iwideo 
 * 
 * Made by Mehmet Celik (https://www.meceware.com/) 
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).iwideo=t()}(this,function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e}function n(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(){this._done=[],this._fail=[]}r.prototype={execute:function(e,t){var o=e.length;for(t=Array.prototype.slice.call(t);o--;)e[o].apply(null,t)},resolve:function(){this.execute(this._done,arguments)},reject:function(){this.execute(this._fail,arguments)},done:function(e){this._done.push(e)},fail:function(e){this._fail.push(e)}};var a=!1,s=!1,l=new r,p=function(){function o(i,n,r,p,u){var c=this,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(t(this,o),this.id=r,this.isValid()){if(!a){a=1;var y=n.createElement("script");y.src="https://www.youtube.com/iframe_api",n.querySelector("body").appendChild(y)}var f;f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t={"videoId":r,playerVars:{autoplay:u.autoplay?1:0,cc_load_policy:0,controls:0,disablekb:1,enablejsapi:1,fs:0,iv_load_policy:3,loop:u.loop?1:0,playlist:r,modestbranding:1,origin:void 0!==i.location.origin?i.location.origin:"".concat(i.location.protocol,"//").concat(i.location.hostname).concat(i.location.port?":"+i.location.port:""),playsinline:1,rel:0,start:0,allowfullscreen:!1,widgetid:1},events:{onReady:function(t){u.mute&&e.player.mute(),d.ready&&d.ready(t)},onStateChange:function(e){switch(e.data){case YT.PlayerState.ENDED:d.end&&d.end(e);break;case YT.PlayerState.PLAYING:d.play&&d.play(e);break;case YT.PlayerState.PAUSED:d.pause&&d.pause(e)}}}},o=n.createElement("div");p.appendChild(o),e.player=new YT.Player(o,t),d.create&&d.create(e.player.getIframe())},"undefined"!=typeof YT&&0!==YT.loaded||s?"object"===("undefined"==typeof YT?"undefined":e(YT))&&1===YT.loaded?f():l.done(function(){f()}):(s=!0,i.onYouTubeIframeAPIReady=function(){i.onYouTubeIframeAPIReady=null,l.resolve("done"),f()})}}return i(o,[{key:"isValid",value:function(){return!!this.id}},{key:"play",value:function(e){this.player&&(void 0!==e&&this.player.seekTo(e||0),YT.PlayerState.PLAYING!==this.player.getPlayerState()&&this.player.playVideo())}},{key:"pause",value:function(){this.player&&YT.PlayerState.PLAYING===this.player.getPlayerState()&&this.player.pauseVideo()}}]),o}(),u=0,c=0,d=new r,y=function(){function e(o,i,n,r){var a=this,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(t(this,e),this.id=i,this.isValid()){if(!u){u=1;var l=o.createElement("script");l.src="https://player.vimeo.com/api/player.js",o.querySelector("body").appendChild(l)}!function(e){if("undefined"!=typeof Vimeo||c)"undefined"!=typeof Vimeo?e():d.done(function(){e()});else{c=!0;var t=setInterval(function(){"undefined"!=typeof Vimeo&&(clearInterval(t),d.resolve("done"),e())},100)}}(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t={autopause:0,autoplay:r.autoplay?1:0,background:1,byline:0,controls:0,loop:r.loop?1:0,muted:r.mute?1:0,portrait:0,transparent:1,title:0,badge:0},l="";Object.keys(t).forEach(function(e){""!==l&&(l+="&"),l+="".concat(e,"=").concat(encodeURIComponent(t[e]))});var p=o.createElement("iframe");p.setAttribute("src","https://player.vimeo.com/video/".concat(i,"?").concat(l)),p.setAttribute("frameborder","0"),p.setAttribute("mozallowfullscreen",""),p.setAttribute("webkitallowfullscreen",""),p.setAttribute("allowfullscreen",""),n.appendChild(p),s.create&&s.create(p),e.player=new Vimeo.Player(p,t),e.player.on("play",function(e){s.play&&s.play(e)}),e.player.on("pause",function(e){s.pause&&s.pause(e)}),e.player.on("ended",function(e){s.end&&s.end(e)}),e.player.on("loaded",function(e){s.ready&&s.ready(e)})})}}return i(e,[{key:"isValid",value:function(){return!!this.id}},{key:"play",value:function(e){var t=this;t.player&&(void 0!==e&&t.player.player.setCurrentTime(e||0),t.player.getPaused().then(function(e){e&&t.player.play()}))}},{key:"pause",value:function(){var e=this;e.player&&e.player.getPaused().then(function(t){t||e.player.pause()})}}]),e}(),f=function(){function e(o,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(t(this,e),this.id=i,this.isValid()){var s=o.createElement("video");r.mute&&(s.muted=!0),s.loop=r.loop,s.setAttribute("playsinline",""),s.setAttribute("webkit-playsinline",""),Object.keys(i).forEach(function(e){var t=o.createElement("source");t.src=i[e],t.type="video/".concat(e),s.appendChild(t)}),this.player=s,n.appendChild(s),a.create&&a.create(s),s.addEventListener("play",function(e){a.play&&a.play(e)}),s.addEventListener("pause",function(e){a.pause&&a.pause(e)}),s.addEventListener("ended",function(e){a.end&&a.end(e)}),s.addEventListener("loadedmetadata",function(){a.ready&&a.ready(),r.autoplay&&s.play()})}}return i(e,[{key:"isValid",value:function(){return!!this.id}},{key:"play",value:function(e){this.player&&(void 0!==e&&(this.player.currentTime=e),this.player.paused&&this.player.play())}},{key:"pause",value:function(){this.player&&(this.player.paused||this.player.pause())}}]),e}();var h,v=function(e,t){return e(t={exports:{}},t.exports),t.exports}(function(e,t){function o(e,t,o,i){var n,r=!1,a=0;function s(){n&&clearTimeout(n)}function l(){var l=this,p=Date.now()-a,u=arguments;function c(){a=Date.now(),o.apply(l,u)}r||(i&&!n&&c(),s(),void 0===i&&p>e?c():!0!==t&&(n=setTimeout(i?function(){n=void 0}:c,void 0===i?e-p:e)))}return"boolean"!=typeof t&&(i=o,o=t,t=void 0),l.cancel=function(){s(),r=!0},l}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=o,t.debounce=function(e,t,i){return void 0===i?o(e,t,!1):o(e,i,!1!==t)}});(h=v)&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")&&h.default;var m=v.throttle;v.debounce;return function(e,o){if(void 0!==e.document){var r={wrapperClass:"iwideo-wrapper",overlayClass:"iwideo-overlay",src:!1,ratio:1.7778,autoplay:!0,extra:!1,loop:!0,mute:!0,poster:"",posterStyle:{size:"cover",position:"center center",repeat:"no-repeat",attachment:"scroll"},"zIndex":-1,autoResize:!0,isMobile:function(){var t=/Android|iPhone|iPad|iPod|BlackBerry|Windows Phone/g.test(navigator.userAgent||navigator.vendor||e.opera);return t||e.innerWidth<768}},a=function(){function n(i){var a=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t(this,n),Object.keys(r).forEach(function(e){Object.prototype.hasOwnProperty.call(s,e)||(s[e]=r[e])}),"string"==typeof s.ratio&&(s.ratio="4/3"===s.ratio?4/3:16/9),this.options=s,this.container="string"==typeof i?o.querySelector(i):i,!this.container)return new Error("Could not find the container: ".concat(i));this.container.iwideo=this;var l,u,c,d,h=(l=this.options.src,u=function(e){var t=e.match(/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/);return!(!t||11!==t[1].length)&&t[1]}(l),c=function(e){var t=e.match(/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/);return!(!t||!t[3])&&t[3]}(l),d=function(e){var t=e.split(/,(?=mp4\:|webm\:|ogv\:|ogg\:)/),o={},i=0;return t.forEach(function(e){var t=e.match(/^(mp4|webm|ogv|ogg)\:(.*)/);t&&t[1]&&t[2]&&(o["ogv"===t[1]?"ogg":t[1]]=t[2],i=1)}),!!i&&o}(l),u?{type:"youtube",id:u}:c?{type:"vimeo",id:c}:d?{type:"html5",id:d}:{type:!1,id:!1});this.type=h.type,this.videoID=h.id;!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=getComputedStyle(e.container,null);"static"===t.getPropertyValue("position")&&(e.container.style.position="relative");var i=o.createElement("div");i.style.position="absolute",e.options.wrapperClass&&("function"==typeof e.options.wrapperClass?i.classList.add(e.options.wrapperClass.call(e)):i.classList.add(e.options.wrapperClass)),i.style.left=0,i.style.top=0,i.style.height="100%",i.style.width="100%",i.style.overflow="hidden",i.style.zIndex=parseInt(e.options.zIndex,10),e.options.poster&&(i.style.backgroundSize=e.options.posterStyle.size,i.style.backgroundPosition=e.options.posterStyle.position,i.style.backgroundRepeat=e.options.posterStyle.repeat,i.style.backgroundAttachment=e.options.posterStyle.attachment,i.style.backgroundImage="url('".concat(e.options.poster,"')")),e.wrapper=i,e.container.insertBefore(i,e.container.firstChild)}(),self.options.isMobile&&self.options.isMobile()||function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,i={ready:function(){t.fire("ready",t)},play:function(e){t.el.style.opacity="1",t.fire("play",t,e)},pause:function(e){t.fire("pause",t,e)},end:function(e){t.options.loop||(t.el.style.opacity="0"),t.fire("end",t,e)},create:function(e){e.style.position="absolute",e.style.left="50%",e.style.top="50%",e.style.transform="translate(-50%, -50%)",e.style.webkitTransform="translate(-50%, -50%)",e.style.msTransform="translate(-50%, -50%)",e.style.oTransform="translate(-50%, -50%)",e.style.mozTransform="translate(-50%, -50%)",e.style.minWidth="100%",e.style.minHeight="100%",e.style.opacity="0",t.options.extra&&Object.keys(t.options.extra).forEach(function(o){e.setAttribute(o,t.options.extra[o])}),t.el=e,t.resize(),t.fire("create",t,e)}};"youtube"===t.type?t.worker=new p(e,o,t.videoID,t.wrapper,t.options,i):"html5"===t.type?t.worker=new f(o,t.videoID,t.wrapper,t.options,i):"vimeo"===t.type&&(t.worker=new y(o,t.videoID,t.wrapper,t.options,i))}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=o.createElement("div");t.style.position="absolute",e.options.overlayClass&&("function"==typeof e.options.overlayClass?t.classList.add(e.options.overlayClass.call(e)):t.classList.add(e.options.overlayClass)),t.style.left=0,t.style.top=0,t.style.height="100%",t.style.width="100%",e.wrapper.appendChild(t)}(),this.options.autoResize&&e.addEventListener("resize",m(200,this.resize).bind(this),!1),this.resize()}return i(n,[{key:"destroy",value:function(){try{this.wrapper.parentNode.removeChild(this.wrapper),delete this.container.iwideo.worker,delete this.container.iwideo}catch(e){}}},{key:"resize",value:function(){if(this.el){var e=this.container.offsetHeight,t=this.container.offsetWidth;1<this.options.ratio&&t/e<this.options.ratio||1>this.options.ratio&&e/t<this.options.ratio?(this.el.style.maxHeight="100%",this.el.style.maxWidth="",this.el.style.height="",this.el.style.width=this.el.offsetHeight*this.options.ratio+200+"px"):(this.el.style.maxHeight="",this.el.style.maxWidth="100%",this.el.style.height=this.el.offsetWidth/this.options.ratio+"px",this.el.style.width="",this.el.offsetHeight<this.wrapper.offsetHeight+140&&(this.el.style.height=this.el.offsetWidth/this.options.ratio+140+"px"))}}},{key:"play",value:function(){return this.worker&&this.worker.play(),this}},{key:"pause",value:function(){return this.worker&&this.worker.pause(),this}},{key:"showPoster",value:function(){this.pause().el.style.opacity="0"}},{key:"on",value:function(e,t){this.userEventsList=this.userEventsList||[],(this.userEventsList[e]||(this.userEventsList[e]=[])).push(t)}},{key:"off",value:function(e,t){var o=this;this.userEventsList&&this.userEventsList[e]&&(t?this.userEventsList[e].forEach(function(i,n){i===t&&(o.userEventsList[e][n]=!1)}):delete this.userEventsList[e])}},{key:"fire",value:function(e){var t=[].slice.call(arguments,1);this.userEventsList&&void 0!==this.userEventsList[e]&&this.userEventsList[e].forEach(function(e){e&&e.apply(this,t)})}}]),n}();return a.destroy=function(e){(e="string"==typeof e?o.querySelector(e):e).iwideo&&e.iwideo.destroy()},a.destroyAll=function(){n(o.querySelectorAll("[data-iwideo]")).forEach(function(e){a.destroy(e)})},a.scan=function(){var e=function(){n(o.querySelectorAll("[data-iwideo]")).forEach(function(e){if(void 0===e.iwideo)try{new a(e,JSON.parse(decodeURIComponent(e.getAttribute("data-iwideo"))))}catch(e){}})};"loading"!=o.readyState?e():o.addEventListener("DOMContentLoaded",e)},a.scan(),a}}("undefined"!=typeof window?window:void 0,document)});
